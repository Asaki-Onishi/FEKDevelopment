# 構築マニュアルver2.1.0

## 目次
0. システム構築の概要  
甲. ログデータ分析システムの構成  
乙. 構築ツールの構造  
丙. 試験構築環境について

1. 作業手順  
1-1. 本マニュアルの記述に関しての留意点  
1-2. OSシステムの更新  


2. 

---

## 0 . システム構築の概要
本マニュアルはFEK基盤と付随する監視アプリケーションのインストール及びビルド作業を支援する手順書である。基本的な作業内容は後述するため、ここでは構築に関してどのような仕組みであるのか、どのようなソフトウェアを使用するのかを説明する。以後、アプリケーションを含むFEK基盤システムを**ログデータ分析システム**、本マニュアルで説明するログ分析システムを構築するプログラムパッケージを**構築ツール**と呼称する。  
> ログデータとは、OSを含めるシステムが稼働する際に出力されるデータ群のことであり、プロセス、エラー、履歴等が記録される。  

### 甲 . ログ分析システムの構成
ログ分析システムは、FEK基盤と監視アプリケーションから構成される。システムの構成に含まれるソフトウェアは全て、GNUプロジェクトに代表されるオープンソースソフトウェア（以後OSSと記述）と自己開発したプログラムから成る。FEK基盤のFEKとは、システムを構成する基幹を担うOSSの頭文字から採ったものである。以下にOSSとプログラムの概要を記述する。

- Fluentd  
基盤を構成するOSSの中で、データの収集及び加工を担うソフトウェア。ログ分析システムにおいては、ログデータの受け取り及びデータの受け渡しを担当する。Fluentdに入力されたデータは、Elasticsearchに保存される。機能を拡張するプラグインが非常に充実していることが特徴である。利用者が必要な機能を必要なだけ導入することが出来るため、ソフトウェア本体だけでなくシステム自体に無駄が少なくコンパクトに実装できるのが強み。

- Elasticsearch  
ログデータ分析システムではログデータの蓄積と管理を行うOSS。Elasticsearch自体は全文検索機能が主機能のソフトウェアであるが、NoSQLの性質上一般的なデータベースと比較してデータ格納に対する高い柔軟性を持つ。Elasticsearchを提供するElastic社は後述するKibana同様にサポートしており、ソフトウェア同士の親和性が非常に高い。

- Kibana  
Elasticsearchに格納されたデータを、分析しグラフ等に可視化するOSS。ログデータ分析システムでは、入力されたデータの状態を確認するために使用される。Kibana本体のデータはElasticsearch内に保存されている。そのため、外部クライアントに異常が発生した場合でも他のコンピュータから接続できる可用性を備える。

- 監視パッケージ
前述したOSSで構成されるFEK基盤を利用する監視システム。Fluentdにアクセスし、ログデータに任意の異常が確認された際に利用者へSlackを通じて通知を行う。


### 乙 . 構築ツールの構造について
構築ツールはシェルスクリプトで記載されており、makeコマンドによって展開することが出来る。本来、FEK基盤の構築には事前に必要なソフトウェアとコマンドをインストールする必要がある。しかし、構築ツールではこれらの複雑な操作を簡略化し自動で必要な各種パッケージを取得・更新を行う。マニュアル閲覧者が、ログ分析システムを展開する際には、少ない手数と多少の待ち時間で構築を行うことが出来る。具体的な操作については別項に譲るが、本項では構築ツールに含まれるプログラム群について多少の説明を行う。  
ツールには以下のプログラムが含まれる。
> Makefile.in  
> configure.in  
> build.sh.in  
> install_strech.sh.in  
> start_set.sh.in  
> saerch.sh.in  
> es.py.in  
> slackbot.sh.in  
> kanshi_config.sh.in  




### 丙 . 試験構築環境について
ログデータ分析システムの構築にあたって、複数の環境での動作を検証するため仮想化ソフトウェアを利用した。試験構築に利用した環境であり、ログデータ分析システムを稼働させる環境としては推奨できない。あくまで参考ために記載しておく。

ホストマシン：Microsoft Surface Pro（第五世代）  

|OS|CPU|Memory|
|---|---|---|
|Windows10 home|Intel Corei5|8 GB|

VirtualBox  version 6.0.14  
ゲストOS概要  

|OS|CPU's Core|Memory|Strage|
|---|---|---|---|
|Debian10 buster(64bit)|2 Proceser|4096 MB|30 GB|

